import os

feature_vector = {}
index = 0
feature_vectors_dir = 'new_feature_vectors/'
feature_indexes_dir = 'features_indexes/'

if not os.path.exists(feature_indexes_dir):
    os.makedirs(feature_indexes_dir)

print("Creating a dictionary that maps features to numeric values...")
for filename in os.listdir(feature_vectors_dir):  # read all apps
    with open(feature_vectors_dir + filename, "r") as file:  # open an app
        for line in file:  # read app line by line
            feature_type = line[:line.find('::')]  # extract feature type
            feature = line.strip()  # remove whitespace chars
                # if a feature is not present in the feature vector, map feature to index and increment index
            if feature not in feature_vector:
                feature_vector[feature] = index
                index = index + 1
print("Finished!")

print("Creating files with numeric values as features...")
for filename in os.listdir(feature_vectors_dir):  # recreate files with indexes
    with open(feature_vectors_dir + filename, "r") as file:  # first open the orignal feature vectors
        f = open(feature_indexes_dir + filename, "a")  # create a new file with the same SHA name in another dir
        for line in file:  # read original feature vectors line by line
            feature_type = line[:line.find('::')]  # extract feature type
            feature = line.strip()  # remove whitespace chars
            f.write(str(feature_vector[feature]) + '\n')  # append the index of the feature to the new file
        f.close()

print("Total features in dataset: ", len(feature_vector))  #
