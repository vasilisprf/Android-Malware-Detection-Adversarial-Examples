"""
This file extracts the unique feature types (classes) present in dataset.
We found a feature type ('') that doesn't belong in any category.
"""
import os

feature_types = {}  # dictionary that will be filled with feature types as keys
index = 1
feature_vectors_dir = '../feature_vectors/'  # directory with features for all apps

print("Creating a dictionary that extracts the feature types (classes)...")
for filename in os.listdir(feature_vectors_dir):  # read all apps
    with open(feature_vectors_dir + filename, "r") as file:  # open an app
        for line in file:  # read app line by line
            feature_type = line[:line.find('::')]  # extract feature type
            if feature_type not in feature_types:  # check if feature type is in dictionary
                feature_types[feature_type] = index  # append feature type as key with the value of index
                index = index + 1  # increment index counter
print("Feature types: ", str(feature_types))
print("Total feature types found: ", len(feature_types))


"""
{
'feature': 1, 
'activity': 2, 
'intent': 3,
'provider': 4,
'call': 5,
'api_call': 6,
'url': 7,
'permission': 8,
'real_permission': 9,
'service_receiver': 10,
'': 11}
"""

"""
We can divide feature types in 8 classes as:
1) provider: Hardware components {S1}
2) permission: Requested Permissions {S2}
3) activity, service_receiver: Components {S3}
4) intent: Intents {S4}
5) call: Restr. API Calls {S5}
6) real_permission: Used Permissions {S6}
7) api_call: Susp. API Calls {S7}
8) url: Network addresses {S8}
-) feature: Not assigned
"""
